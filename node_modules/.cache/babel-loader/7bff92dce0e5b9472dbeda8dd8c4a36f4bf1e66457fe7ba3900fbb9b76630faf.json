{"ast":null,"code":"var _jsxFileName = \"/home/webexpert/Desktop/colin/tes/src/App.tsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport \"./AuthForm.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function AuthForm() {\n  _s();\n  const [formData, setFormData] = useState({\n    userId: \"\",\n    access_token: \"\"\n  });\n  const [loading, setLoading] = useState(false);\n  const [errors, setErrors] = useState({});\n  const [widgetError, setWidgetError] = useState(null);\n  const [showClientAuthForm, setShowClientAuthForm] = useState(false);\n  const handleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setFormData(prev => ({\n      ...prev,\n      [name]: value\n    }));\n    setErrors(prevErrors => {\n      const newErrors = {\n        ...prevErrors\n      };\n      if (newErrors[name]) {\n        delete newErrors[name];\n      }\n      return newErrors;\n    });\n  };\n  const handleSubmit = e => {\n    e.preventDefault();\n    setWidgetError(null);\n    setLoading(true);\n    const newErrors = {};\n    if (!formData.userId) newErrors.userId = \"User ID is required.\";\n    if (!formData.access_token) newErrors.access_token = \"Access Token is required.\";\n    if (Object.keys(newErrors).length > 0) {\n      setErrors(newErrors);\n      setShowClientAuthForm(false);\n      setLoading(false); // Don't forget to stop loading on error\n    } else {\n      setErrors({});\n      setShowClientAuthForm(true);\n      // Let the widget handle further async work — stop loading right after form show\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    if (!showClientAuthForm) {\n      // Cleanup if widget is not shown\n      const existingScript = document.getElementById(\"widget-script\");\n      if (existingScript) existingScript.remove();\n      const existingLink = document.getElementById(\"widget-style\");\n      if (existingLink) existingLink.remove();\n      const widgetContainer = document.getElementById(\"widget-container\");\n      if (widgetContainer) widgetContainer.remove();\n      return;\n    }\n\n    // Prevent double-inject\n    if (document.getElementById(\"widget-script\")) return;\n\n    // Inject widget.js with user data attributes\n    const script = document.createElement(\"script\");\n    script.id = \"widget-script\";\n    // script.src = \"http://localhost:4000/widgets/widget.js\";\n    script.src = \"https://widget-jzf7il9cv-ritanshus-projects-ba7180e1.vercel.app/widgets/widget.js\";\n    script.async = true;\n    script.setAttribute(\"data-userid\", formData.userId);\n    script.setAttribute(\"data-access_token\", formData.access_token);\n    document.body.appendChild(script);\n\n    // Inject style.css\n    const link = document.createElement(\"link\");\n    link.rel = \"stylesheet\";\n    link.href = \"http://localhost:4000/widgets/style.css\";\n    link.id = \"widget-style\";\n    document.head.appendChild(link);\n    return () => {\n      script.remove();\n      link.remove();\n      const widgetContainer = document.getElementById(\"widget-container\");\n      if (widgetContainer) widgetContainer.remove();\n    };\n  }, [showClientAuthForm, formData.userId, formData.access_token]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: widgetError != null || showClientAuthForm ? \"\" : \"auth-form-container\",\n    children: widgetError == null && !showClientAuthForm && /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      noValidate: true,\n      className: \"auth-form\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"form-title\",\n        children: \"Authentication Form\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-semibold text-gray-700\",\n          children: \"User ID\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"userId\",\n          value: formData.userId,\n          onChange: handleChange,\n          className: \"w-full px-4 py-2 mt-1 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 13\n        }, this), errors.userId && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-red-500 mt-1\",\n          children: errors.userId\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Access Token\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"access_token\",\n          value: formData.access_token,\n          onChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 13\n        }, this), errors.access_token && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"error\",\n          children: errors.access_token\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"submit-btn\",\n        disabled: loading,\n        children: loading ? \"Loading...\" : \"Add\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 102,\n    columnNumber: 5\n  }, this);\n}\n_s(AuthForm, \"64Qvu3FP1VFHsYt0ujS/e61bTwA=\");\n_c = AuthForm;\nvar _c;\n$RefreshReg$(_c, \"AuthForm\");","map":{"version":3,"names":["useState","useEffect","jsxDEV","_jsxDEV","AuthForm","_s","formData","setFormData","userId","access_token","loading","setLoading","errors","setErrors","widgetError","setWidgetError","showClientAuthForm","setShowClientAuthForm","handleChange","e","name","value","target","prev","prevErrors","newErrors","handleSubmit","preventDefault","Object","keys","length","existingScript","document","getElementById","remove","existingLink","widgetContainer","script","createElement","id","src","async","setAttribute","body","appendChild","link","rel","href","head","className","children","onSubmit","noValidate","fileName","_jsxFileName","lineNumber","columnNumber","type","onChange","disabled","_c","$RefreshReg$"],"sources":["/home/webexpert/Desktop/colin/tes/src/App.tsx"],"sourcesContent":["import { useState, ChangeEvent, FormEvent, useEffect } from \"react\";\nimport \"./AuthForm.css\";\n\ninterface FormData {\n  userId: string;\n  access_token: string;\n}\n\ninterface FormErrors {\n  userId?: string;\n  access_token?: string;\n}\n\nexport default function AuthForm() {\n  const [formData, setFormData] = useState<FormData>({\n    userId: \"\",\n    access_token: \"\",\n  });\n  const [loading, setLoading] = useState<boolean>(false);\n  const [errors, setErrors] = useState<FormErrors>({});\n  const [widgetError, setWidgetError] = useState<string | null>(null);\n  const [showClientAuthForm, setShowClientAuthForm] = useState<boolean>(false);\n\n  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n\n    setFormData((prev) => ({ ...prev, [name]: value }));\n\n    setErrors((prevErrors) => {\n      const newErrors = { ...prevErrors };\n      if (newErrors[name as keyof FormErrors]) {\n        delete newErrors[name as keyof FormErrors];\n      }\n      return newErrors;\n    });\n  };\n\n  const handleSubmit = (e: FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    setWidgetError(null);\n    setLoading(true);\n\n    const newErrors: FormErrors = {};\n    if (!formData.userId) newErrors.userId = \"User ID is required.\";\n    if (!formData.access_token)\n      newErrors.access_token = \"Access Token is required.\";\n\n    if (Object.keys(newErrors).length > 0) {\n      setErrors(newErrors);\n      setShowClientAuthForm(false);\n      setLoading(false); // Don't forget to stop loading on error\n    } else {\n      setErrors({});\n      setShowClientAuthForm(true);\n      // Let the widget handle further async work — stop loading right after form show\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    if (!showClientAuthForm) {\n      // Cleanup if widget is not shown\n      const existingScript = document.getElementById(\"widget-script\");\n      if (existingScript) existingScript.remove();\n      const existingLink = document.getElementById(\"widget-style\");\n      if (existingLink) existingLink.remove();\n      const widgetContainer = document.getElementById(\"widget-container\");\n      if (widgetContainer) widgetContainer.remove();\n      return;\n    }\n\n    // Prevent double-inject\n    if (document.getElementById(\"widget-script\")) return;\n\n    // Inject widget.js with user data attributes\n    const script = document.createElement(\"script\");\n    script.id = \"widget-script\";\n    // script.src = \"http://localhost:4000/widgets/widget.js\";\n    script.src = \"https://widget-jzf7il9cv-ritanshus-projects-ba7180e1.vercel.app/widgets/widget.js\";\n\n    script.async = true;\n    script.setAttribute(\"data-userid\", formData.userId);\n    script.setAttribute(\"data-access_token\", formData.access_token);\n    document.body.appendChild(script);\n\n    // Inject style.css\n    const link = document.createElement(\"link\");\n    link.rel = \"stylesheet\";\n    link.href = \"http://localhost:4000/widgets/style.css\";\n    link.id = \"widget-style\";\n    document.head.appendChild(link);\n\n    return () => {\n      script.remove();\n      link.remove();\n      const widgetContainer = document.getElementById(\"widget-container\");\n      if (widgetContainer) widgetContainer.remove();\n    };\n  }, [showClientAuthForm, formData.userId, formData.access_token]);\n\n  return (\n    <div\n      className={\n        widgetError != null || showClientAuthForm ? \"\" : \"auth-form-container\"\n      }\n    >\n      {widgetError == null && !showClientAuthForm && (\n        <form onSubmit={handleSubmit} noValidate className=\"auth-form\">\n          <h2 className=\"form-title\">Authentication Form</h2>\n          <div className=\"form-group\">\n            <label className=\"block text-sm font-semibold text-gray-700\">\n              User ID\n            </label>\n            <input\n              type=\"text\"\n              name=\"userId\"\n              value={formData.userId}\n              onChange={handleChange}\n              className=\"w-full px-4 py-2 mt-1 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n            {errors.userId && (\n              <p className=\"text-sm text-red-500 mt-1\">{errors.userId}</p>\n            )}\n          </div>\n\n          <div className=\"form-group\">\n            <label>Access Token</label>\n            <input\n              type=\"text\"\n              name=\"access_token\"\n              value={formData.access_token}\n              onChange={handleChange}\n            />\n            {errors.access_token && (\n              <p className=\"error\">{errors.access_token}</p>\n            )}\n          </div>\n\n          <button type=\"submit\" className=\"submit-btn\" disabled={loading}>\n            {loading ? \"Loading...\" : \"Add\"}\n          </button>\n        </form>\n      )}\n\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}